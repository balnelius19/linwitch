<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Oracle Divinatoire</title>
  <style>
    body {
      background: linear-gradient(to right, #1e3c72, #2a5298);
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }

    .container {
      text-align: center;
      max-width: 600px;
      padding: 30px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    }

    h1 {
      font-size: 2em;
      margin-bottom: 20px;
    }

    #oracle {
      font-size: 1.5em;
      margin: 20px 0;
      min-height: 60px;
    }

    button {
      padding: 12px 24px;
      font-size: 1.1em;
      background-color: #f39c12;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
      margin: 5px;
    }

    button:hover {
      background-color: #e67e22;
    }

    #history {
      margin-top: 20px;
      font-size: 1em;
      text-align: left;
    }

    .disabled {
      background-color: #999 !important;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîÆ Oracle Divinatoire</h1>
    <p id="oracle">Clique sur le bouton pour r√©v√©ler ton message...</p>
    <button id="oracleBtn" onclick="generateOracle()">‚ú® Tirer une phrase</button>
    <button onclick="downloadHistory()">üìÅ T√©l√©charger l‚Äôhistorique</button>
    <div id="history"></div>
  </div>

  <script>
    const subjects = [
      { text: "Le vent", plural: false }, { text: "La lumi√®re", plural: false },
      { text: "Les √©toiles", plural: true }, { text: "Le silence", plural: false },
      { text: "Les murmures", plural: true }, { text: "La nuit", plural: false },
      { text: "Les ombres", plural: true }, { text: "Le feu", plural: false },
      { text: "La m√©moire", plural: false }, { text: "Les secrets", plural: true },
      { text: "Le destin", plural: false }, { text: "Les voix", plural: true },
      { text: "La pluie", plural: false }, { text: "Les cris", plural: true },
      { text: "Le doute", plural: false }, { text: "La beaut√©", plural: false },
      { text: "Les reflets", plural: true }, { text: "Le r√™ve", plural: false },
      { text: "Les souffles", plural: true }, { text: "La peur", plural: false }
    ];

    const verbs = {
      singular: [
        "apaise", "r√©v√®le", "nourrit", "embrasse", "ignore", "transforme", "d√©voile", "choisit", "prot√®ge", "traverse",
        "c√©l√®bre", "observe", "accueille", "lib√®re", "d√©chire", "honore", "cherche", "trouve", "perd", "suit",
        "fuit", "construit", "d√©passe", "sent", "√©coute", "oublie", "r√™ve", "saisit", "couvre", "√©claire", "inspire", "d√©fie", "absorbe"
      ],
      plural: [
        "apaisent", "r√©v√®lent", "nourrissent", "embrassent", "ignorent", "transforment", "d√©voilent", "choisissent", "prot√®gent", "traversent",
        "c√©l√®brent", "observent", "accueillent", "lib√®rent", "d√©chirent", "honorent", "cherchent", "trouvent", "perdent", "suivent",
        "fuient", "construisent", "d√©passent", "sentent", "√©coutent", "oublient", "r√™vent", "saisissent", "couvrent", "√©clairent", "inspirent", "d√©fient", "absorbent"
      ]
    };

    const complements = [
      "la douleur", "la peur", "le r√™ve", "le pass√©", "la beaut√©", "le chaos", "la sagesse", "le souffle", "le cri", "le doute",
      "l‚Äôamour", "le myst√®re", "la v√©rit√©", "les √©toiles", "la m√©moire", "les ombres", "le silence", "le feu", "la lumi√®re", "le destin",
      "les murmures", "la nuit", "les secrets", "le vent", "la voix", "l‚Äôinstant", "le chemin", "la pluie", "les reflets", "le pr√©sent",
      "la force", "le d√©sir", "l‚Äô√©cho"
    ];

    function getRandom(array) {
      return array[Math.floor(Math.random() * array.length)];
    }

    function generateOracle() {
      const usage = JSON.parse(localStorage.getItem("oracleUsage")) || { count: 0, lastReset: Date.now() };
      const now = Date.now();
      const oneDay = 24 * 60 * 60 * 1000;

      if (now - usage.lastReset > oneDay) {
        usage.count = 0;
        usage.lastReset = now;
      }

      if (usage.count >= 3) {
        document.getElementById("oracle").textContent = "‚õî Limite atteinte : 3 tirages par 24h.";
        document.getElementById("oracleBtn").classList.add("disabled");
        return;
      }

      const subject = getRandom(subjects);
      const verb = subject.plural ? getRandom(verbs.plural) : getRandom(verbs.singular);
      const complement = getRandom(complements);
      const phrase = `${subject.text} ${verb} ${complement}.`;

      document.getElementById("oracle").textContent = phrase;

      usage.count++;
      localStorage.setItem("oracleUsage", JSON.stringify(usage));

      const history = JSON.parse(localStorage.getItem("oracleHistory")) || [];
      history.push({ phrase, date: new Date().toLocaleDateString("fr-FR") + ", " + new Date().toLocaleTimeString("fr-FR") });
      localStorage.setItem("oracleHistory", JSON.stringify(history));
      updateHistory();
    }

    function updateHistory() {
      const history = JSON.parse(localStorage.getItem("oracleHistory")) || [];
      const container = document.getElementById("history");
      container.innerHTML = "<h3>üìù Historique des tirages :</h3><ul>" +
        history.slice(-5).reverse().map(item => `<li>${item.date} ‚Äî ${item.phrase}</li>`).join("") +
        "</ul>";
    }

    function checkLimit() {
      const usage = JSON.parse(localStorage.getItem("oracleUsage")) || { count: 0, lastReset: Date.now() };
      const now = Date.now();
      const oneDay = 24 * 60 * 60 * 1000;

      if (now - usage.lastReset > oneDay) {
        usage.count = 0;
        usage.lastReset = now;
        localStorage.setItem("oracleUsage", JSON.stringify(usage));
      }

      if (usage.count >= 3) {
        document.getElementById("oracleBtn").classList.add("disabled");
        document.getElementById("oracle").textContent = "‚õî Limite atteinte : 3 tirages par 24h.";
      }
    }

    function downloadHistory() {
      const history = JSON.parse(localStorage.getItem("oracleHistory")) || [];
      if (history.length === 0) {
        alert("Aucun tirage enregistr√©.");
        return;
      }
           const grouped = {};
      history.forEach(item => {
        const date = item.date.split(",")[0].trim();
        if (!grouped[date]) grouped[date] = [];
        grouped[date].push(item.phrase);
      });
      
            let content = "üìú Journal des tirages divinatoires\n\n";
      for (const date in grouped) {
        content += `üìÖ ${date}\n`;
        grouped[date].forEach((phrase, index) => {
          content += `  ${index + 1}. ${phrase}\n`;
        });
        content += "\n";
      }

      content += "üîÆ Que les √©toiles te guident √† jamais.\n";

      const today = new Date().toISOString().split("T")[0];
      const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `oracle_${today}.txt`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // Initialisation
    updateHistory();
    checkLimit();
  </script>
</body>
</html>

